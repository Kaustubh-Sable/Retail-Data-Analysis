In this project we have used Market Basket Analysis (MBA), also known as associative rule learning or affinity analysis. It is a modeling technique based upon the theory that if you buy a certain set of items, you are likely to buy another set of items. This will allow retailers to identify relationships between the items that people buy. We have built a XGBoost model using time series forecasting that predicts the future product demand that will help in inventory management.

#### Data Preprocessing:
We encountered certain irregularities in the dataset and resolved them as below:
* Each month’s data is preceded by a header row that consists of column headers. We removed these redundant header row records.
* Removing erroneous value ’nx1a’ in the ’Date’ feature. We then converted the column to DateTime format for further use and processing. 
* Label encoding for categorical features like ’Store #’ and ’Item Number’.
* Treating null values from all the features. 
* Net Sales Units and Gross Margin columns consisted of values in different formats like ‘1000.00’, ‘1,000’ and ‘1000’. These values are converted to a numeric format.

#### Model:
Features used: ‘Receipt Number’, ‘Item Description’. 

#####Description:
Each receipt number denotes one basket against which items are purchased. We have used Item Description to identify each item in a basket. First, we performed MBA using **Apriori** algorithm on all the stores. However, we observed that the item ‘CMN Donations’ (which is not really an item) is occurring almost in each association rule. Also, there are certain item descriptions that depict promotional codes containing strings like INST SAVINGS, COUPON SAVE and thus cannot be considered as actual items. Hence, we removed the entries for these records. We observed that ‘Fasteners’ is an item that is frequently bought, almost with all the items. Hence, to identify significant associations, we removed ’Fasteners’ records.

To perform MBA, we consolidated the items into one transaction per row, ie, all items with the same receipt number form a single row. Now, ’Receipt Number’ is our index and all the items form the columns. We then performed one hot encoding on the columns, ie, when the item is present in the basket (any positive net sales units value), the value of that column is one otherwise, zero.

To perform MBA, we consolidated the items into one transaction per row, ie, all items with the same receipt number form a single row. Now, ’Receipt Number’ is our index and all the items form the columns. We then performed one hot encoding on the columns, ie, when the item is present in the basket (any positive net sales units value), the value of that column is one otherwise, zero.

![Multi-Armed Bandit Problem](https://github.com/Kaustubh-Sable/Retail-Data-Analysis/blob/master/Market_Basket_Analysis/Images/MBA_Association_Rules.png)

Above figure depicts the association rules generated by MBA. From the output, the lift of the association rule if ’Orange Burst Suet’ then ’Berry Blast Suet’ is 25.18 and the confidence is 55%. This means that consumers who purchase Orange Burst Suet are 25.18 times more likely to purchase Berry Blast Suet than randomly chosen customers. Larger lift means more interesting rules. Association rules with high support are potentially interesting rules. Similarly, rules with high confidence are interesting rules as well. For example, there is a definite association between ORANGE BURST SUET and BERRY BLAST SUET. Which means there is a high chance that the two things will co-occur in a basket. We can also see some strong associations between other items which are bought together like KEY SCHLAGE and KEY KWIKSET. Hence, optimally placing the associated items in the store can help increase the revenue.

Visualization of Association Rules:

![Association Rules Visualization](https://github.com/Kaustubh-Sable/Retail-Data-Analysis/blob/master/Market_Basket_Analysis/Images/Association_Rules_Visualization.png)


#### References
* Manpreet Kaura, Shivani Kanga (CMS 2016). Market Basket Analysis: Identify the changing trends of market data using association rule mining.
* Introduction to Market Basket Analysis: https://pbpython.com/market-basket-analysis.html
* Frequent Itemsets via Apriori Algorithm: http://rasbt.github.io/mlxtend/user guide/frequent patterns/apriori
* Andrej Trnka (2010). Market Basket Analysis with Data Mining methods.
* https://intelligentonlinetools.com/blog/2018/02/10/how-to-create-data-visualization-for-association-rules-in-datamining/
